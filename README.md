# Robinhood Cryptocurrency Trading Bot

**Author:** Aaron Marcello Aldana

A Python-based bot designed for automated cryptocurrency trading analysis and execution on Robinhood using the official Robinhood Crypto Trading API.

**Disclaimer:** Trading cryptocurrencies involves significant risk. This bot is provided for educational purposes only and should not be used for live trading without thorough testing, understanding the code, and accepting the risks involved. The authors are not responsible for any financial losses.

## Features

*   **Direct Robinhood API Integration:** Uses the official Robinhood Crypto Trading API for secure authentication and trading operations.
*   **Multiple Analysis Strategies:** Includes strategies like:
    *   Moving Average Crossover (SMA)
    *   Relative Strength Index (RSI)
    *   Price Channel Breakout
    *   (Easily extendable for more strategies)
*   **Configurable:** Set symbols, strategy, trading amount, intervals, and API keys via an environment file (`.env`).
*   **Data Source:** Utilizes CoinGecko (via `AltCryptoDataProvider`) for fetching historical price data required for analysis.
*   **Automated Trading:** Places market buy/sell orders based on strategy signals (if enabled).
*   **Scheduling:** Runs analysis and trading cycles at configurable intervals using `schedule`.
*   **Logging:** Detailed logging of operations, signals, trades, and errors.
*   **Optional Plotting:** Generates plots of price data and indicators for visual analysis (if enabled).

## Prerequisites

*   Python 3.8+
*   A Robinhood account with Crypto Trading enabled.
*   Robinhood Crypto API Key and Private Key (generated from the [Robinhood API Credentials Portal](https://robinhood.com/account/settings/api-security) - requires desktop browser).

## Setup

1.  **Clone the repository:**
    ```bash
    git clone <repository_url>
    cd robinhood-crypto-bot
    ```

2.  **Create a virtual environment (recommended):**
    ```bash
    python -m venv venv
    source venv/bin/activate # On Windows use `venv\Scripts\activate`
    ```

3.  **Install dependencies:**
    ```bash
    pip install -r requirements.txt
    ```

4.  **Configure Environment Variables:**
    *   Copy the example environment file:
        ```bash
        cp .env.example .env
        ```
    *   **Edit the `.env` file:**
        *   **`ROBINHOOD_API_KEY`**: Your API Key obtained from the Robinhood portal.
        *   **`ROBINHOOD_PRIVATE_KEY`**: Your **Base64-encoded** private key corresponding to the API key.
        *   `SYMBOLS`: Comma-separated list of crypto symbols in `ASSET-USD` format (e.g., `BTC-USD,ETH-USD,DOGE-USD`).
        *   `TRADING_STRATEGY`: Choose the strategy (`moving_average`, `rsi`, `breakout`).
        *   `ENABLE_TRADING`: Set to `true` to allow the bot to place real trades, `false` for analysis-only mode.
        *   `TRADE_AMOUNT_USD`: The approximate US dollar amount for each BUY trade.
        *   `CHECK_INTERVAL_MINUTES`: How often (in minutes) the bot runs its analysis cycle.
        *   `LOOKBACK_DAYS`: How many days of historical data to fetch for analysis.
        *   `LOG_LEVEL`: Logging detail (e.g., `INFO`, `DEBUG`).
        *   `PLOT_ENABLED`: Set to `true` to generate plots for each analysis cycle.
        *   (Optional: `LOG_FILE`, `PLOT_OUTPUT_DIR`)

    **Security Note:** Your `ROBINHOOD_PRIVATE_KEY` is highly sensitive. Ensure the `.env` file is **never** committed to version control (it's included in `.gitignore` by default).

## Generating API Keys

1.  Go to the [Robinhood Crypto API Keys Page](https://robinhood.com/account/crypto) (requires desktop browser).
2.  Follow the instructions to create a new API credential.
3.  **Generate an Ed25519 key pair using the script below.**
    ```python
    import nacl.signing
    import base64

    # Generate an Ed25519 keypair
    private_key = nacl.signing.SigningKey.generate()
    public_key = private_key.verify_key

    # Convert keys to base64 strings
    private_key_base64 = base64.b64encode(private_key.encode()).decode('utf-8')
    public_key_base64 = base64.b64encode(public_key.encode()).decode('utf-8')

    print("Private Key (Base64 - add this to .env as ROBINHOOD_PRIVATE_KEY):")
    print(private_key_base64)
    print("\nPublic Key (Base64 - use this when creating the credential in Robinhood Portal):")
    print(public_key_base64)
    ```
    Run it with `python generate_keys.py`.
4.  **When creating the credential in the portal, provide the _Public Key (Base64)_ (not the private key!) in the 'Public key' field.**
    - _Never register your private key as the public key in the portal. This will cause signature verification to fail._
5.  The portal will then give you an **API Key**. Add this to your `.env` file as `ROBINHOOD_API_KEY`.
6.  Add the **Private Key (Base64)** generated by the script to your `.env` file as `ROBINHOOD_PRIVATE_KEY`.

### Robinhood API Key Registration Gotchas

- **The 'Public key' field in the Robinhood portal must be populated with your Ed25519 public key in base64 format.**
- **Do NOT paste your private key into the public key field.**
- **Your `.env` file should contain only the API key and the private key (base64).**
- **Never share your private key with anyone.**
- If you accidentally register the private key as the public key, _signature verification will always fail_. Delete the credential and repeat the process with the correct public key.

**Example `.env` entries:**
```env
ROBINHOOD_API_KEY=rh-api-xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
ROBINHOOD_PRIVATE_KEY=your_base64_private_key_here
ROBINHOOD_USERNAME=your_robinhood_username
ROBINHOOD_PASSWORD=your_robinhood_password
# ROBINHOOD_MFA_CODE=your_current_mfa_code  # Only needed if MFA is enabled
```

## Running the Bot

```bash
python crypto_bot.py
```

The bot will start, perform an initial analysis cycle, and then run scheduled cycles based on `CHECK_INTERVAL_MINUTES`. View logs in `crypto_bot.log` (or the console) and plots in the `plots/` directory (if enabled).

Press `Ctrl+C` to stop the bot gracefully.

## Development

*   **Adding Strategies:**
    1.  Create a new method in `RobinhoodCryptoBot` named `analyze_<strategy_name>_strategy(self, df: pd.DataFrame) -> str`.
    2.  Implement your logic using the pandas DataFrame (`df`) containing historical data.
    3.  The method should return `'buy'`, `'sell'`, or `'hold'`.
    4.  Update the `analyze_symbol` method to include an `elif` condition for your new strategy name.
    5.  Set `TRADING_STRATEGY` in `.env` to your new strategy name.
*   **Data Providers:** The bot uses `AltCryptoDataProvider` (CoinGecko). You could potentially add or switch data providers by modifying the `_fetch_historical_data` method and the `__init__` section.

## Important Considerations

*   **API Rate Limits:** The Robinhood API has rate limits. If you run the bot too frequently (low `CHECK_INTERVAL_MINUTES`), you might encounter errors.
*   **Market Orders:** The bot currently uses market orders, which can be subject to slippage (execution price differing from the expected price). Consider implementing limit orders for more price control.
*   **Error Handling:** While basic error handling is included, robust error handling for network issues, API errors, and unexpected data is crucial for a reliable trading bot.
*   **Testing:** **Thoroughly test** the bot in analysis-only mode (`ENABLE_TRADING=false`) before enabling live trading.
*   **Security:** Protect your API keys and `.env` file diligently.

## Contributing

Contributions are welcome! Please feel free to submit pull requests or open issues.
